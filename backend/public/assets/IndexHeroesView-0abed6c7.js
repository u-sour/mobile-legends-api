import{d as T,n as B,a as O,y as u,z as P,q as F,o as s,c as n,b as v,s as r,x as H,A as M,w as $,j as d,E as q,F as x,m as y,B as p,t as E,C as S,i as U,k,H as A,l as L,I as j}from"./index-695f870a.js";import{_ as z}from"./EasyDataTableActions.vue_vue_type_script_setup_true_lang-645ff60c.js";import{A as G}from"./alert-message-757f299f.js";const W={id:"index-hero"},Y=["onSubmit"],J={key:0,class:"d-flex"},K={class:"badge text-bg-light fs-6 mt-2"},Q=v("i",{class:"bi bi-shop"},null,-1),X=v("br",null,null,-1),Z={key:0},ee={key:0},ne=T({__name:"IndexHeroesView",setup(te){const N=B(),I=O(),l=u(!1),i=u(),w=u(0),{page:_,limit:h}=N.query,c=u({page:parseInt((_==null?void 0:_.toString())||"1"),rowsPerPage:parseInt((h==null?void 0:h.toString())||"25")}),V=[{text:"NAME",value:"name"},{text:"CODE",value:"code"},{text:"ROLE(s)",value:"roleIds"},{text:"SPECIALTIES",value:"specialtyIds"},{text:"LANING",value:"lane"},{text:"RELEASE YEAR",value:"release_year"},{text:"Operation",value:"operation",width:161}],m=u([]),g=async()=>{l.value=!0;const{page:o,rowsPerPage:a}=c.value;I.replace({name:"heroes",query:i.value?{search:i.value,page:o,limit:a}:{page:o,limit:a}});const{heroes:f,serverTotalHeroesLength:e}=await A.findWithAggregateNoRateLimit({search:i.value,page:o,rowsPerPage:a});m.value=f,w.value=e,l.value=!1};g(),P(c,()=>{g()},{deep:!0});const C=()=>{g()},D=o=>{I.push({name:"edit.heroes",params:{id:o._id}})},R=async o=>{l.value=!0,await A.delete(o._id).then(async()=>{l.value=!1,m.value=m.value.filter(a=>a._id!==o._id),L.success(G.deleteSuccess(o._id))}).catch(a=>{L.error(a.data.message)})};return(o,a)=>{const f=F("EasyDataTable");return s(),n("div",W,[v("form",{onSubmit:$(C,["prevent"])},[r(H(M),{type:"text","prefix-icon":"search",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),placeholder:"Search...",autocomplete:"off"},null,8,["modelValue"])],40,Y),r(f,{"show-index":"",headers:V,items:m.value,"buttons-pagination":"","server-options":c.value,"onUpdate:serverOptions":a[1]||(a[1]=e=>c.value=e),"server-items-length":w.value,loading:l.value},{loading:d(()=>[r(q)]),expand:d(e=>[e.skins?(s(),n("div",J,[(s(!0),n(x,null,y(e.skins,t=>(s(),n("div",{key:t.name,class:"w-auto me-3"},[v("span",K,[Q,p(" "+E(t.name),1)]),X,r(S,{"public-id":t.icon_public_id,name:t.name,class:"avatar-1 border border-2 rounded-circle"},null,8,["public-id","name"]),p(" | "),r(S,{"public-id":t.splash_art_public_id,name:t.name,class:"avatar-1 border rounded-1 m-1"},null,8,["public-id","name"])]))),128))])):(s(),U(j,{key:1}))]),"item-roleIds":d(({roleIds:e})=>[(s(!0),n(x,null,y(e,(t,b)=>(s(),n("span",{key:t._id},[p(E(t.name),1),b!==e.length-1?(s(),n("span",Z," / ")):k("",!0)]))),128))]),"item-specialtyIds":d(({specialtyIds:e})=>[(s(!0),n(x,null,y(e,(t,b)=>(s(),n("span",{key:t._id},[p(E(t.name),1),b!==e.length-1?(s(),n("span",ee," / ")):k("",!0)]))),128))]),"item-operation":d(e=>[r(z,{onEdit:t=>D(e),onDelete:t=>R(e)},null,8,["onEdit","onDelete"])]),_:1},8,["items","server-options","server-items-length","loading"])])}}});export{ne as default};
