import{d as k,n as B,a as O,y as u,z as P,q as R,o as s,c as n,b as r,s as p,x as F,A as H,w as M,j as d,E as q,F as x,m as E,B as v,t as b,i as z,k as S,H as A,l as V,I as $}from"./index-69cc5271.js";import{_ as U}from"./EasyDataTableActions.vue_vue_type_script_setup_true_lang-373a34ca.js";import{A as j}from"./alert-message-757f299f.js";const G={id:"index-hero"},W=["onSubmit"],Y={key:0,class:"d-flex"},J={class:"badge text-bg-light fs-6 mt-2"},K=r("i",{class:"bi bi-shop"},null,-1),Q=r("br",null,null,-1),X=["role","alt","title","src"],Z=["role","alt","title","src"],ee={key:0},te={key:0},re=k({__name:"IndexHeroesView",setup(ae){const L=B(),I=O(),l=u(!1),i=u(),w=u(0),{page:_,limit:h}=L.query,c=u({page:parseInt((_==null?void 0:_.toString())||"1"),rowsPerPage:parseInt((h==null?void 0:h.toString())||"25")}),N=[{text:"NAME",value:"name"},{text:"CODE",value:"code"},{text:"ROLE(s)",value:"roleIds"},{text:"SPECIALTIES",value:"specialtyIds"},{text:"LANING",value:"lane"},{text:"RELEASE YEAR",value:"release_year"},{text:"Operation",value:"operation",width:161}],m=u([]),g=async()=>{l.value=!0;const{page:o,rowsPerPage:a}=c.value;I.replace({name:"heroes",query:i.value?{search:i.value,page:o,limit:a}:{page:o,limit:a}});const{heroes:f,serverTotalHeroesLength:t}=await A.findWithAggregate({search:i.value,page:o,rowsPerPage:a});m.value=f,w.value=t,l.value=!1};g(),P(c,()=>{g()},{deep:!0});const C=()=>{g()},D=o=>{I.push({name:"edit.heroes",params:{id:o._id}})},T=async o=>{l.value=!0,await A.delete(o._id).then(async()=>{l.value=!1,m.value=m.value.filter(a=>a._id!==o._id),V.success(j.deleteSuccess(o._id))}).catch(a=>{V.error(a.data.message)})};return(o,a)=>{const f=R("EasyDataTable");return s(),n("div",G,[r("form",{onSubmit:M(C,["prevent"])},[p(F(H),{type:"text","prefix-icon":"search",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t),placeholder:"Search...",autocomplete:"off"},null,8,["modelValue"])],40,W),p(f,{"show-index":"",headers:N,items:m.value,"buttons-pagination":"","server-options":c.value,"onUpdate:serverOptions":a[1]||(a[1]=t=>c.value=t),"server-items-length":w.value,loading:l.value},{loading:d(()=>[p(q)]),expand:d(t=>[t.skins?(s(),n("div",Y,[(s(!0),n(x,null,E(t.skins,e=>(s(),n("div",{key:e.name,class:"w-auto me-3"},[r("span",J,[K,v(" "+b(e.name),1)]),Q,r("img",{class:"avatar-1 border rounded-circle m-1",loading:"lazy",role:e.name,alt:e.name,title:e.name,src:e.icon_url},null,8,X),v(" | "),r("img",{class:"avatar-1 border rounded-1 m-1",loading:"lazy",role:e.name,alt:e.name,title:e.name,src:e.splash_art_url},null,8,Z)]))),128))])):(s(),z($,{key:1}))]),"item-roleIds":d(({roleIds:t})=>[(s(!0),n(x,null,E(t,(e,y)=>(s(),n("span",{key:e._id},[v(b(e.name),1),y!==t.length-1?(s(),n("span",ee," / ")):S("",!0)]))),128))]),"item-specialtyIds":d(({specialtyIds:t})=>[(s(!0),n(x,null,E(t,(e,y)=>(s(),n("span",{key:e._id},[v(b(e.name),1),y!==t.length-1?(s(),n("span",te," / ")):S("",!0)]))),128))]),"item-operation":d(t=>[p(U,{onEdit:e=>D(t),onDelete:e=>T(t)},null,8,["onEdit","onDelete"])]),_:1},8,["items","server-options","server-items-length","loading"])])}}});export{re as default};
